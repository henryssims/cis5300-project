SARI evaluation

Citation: Xu, W., Napoles, C., Pavlick, E., Chen, Q., & Callison-Burch, C. (2016). Optimizing Statistical Machine Translation for Text Simplification. *Transactions of the Association for Computational Linguistics*, 4, 401-415. https://aclanthology.org/Q16-1029/


SARI measures simplification quality by comparing the system output against both the source sentence and human reference simplifications. It evaluates three operations:

1. Keep: Words appropriately retained from the source
2. Delete: Words appropriately removed from the source  
3. Add: Words appropriately added that weren't in the source

For each operation, SARI computes precision and recall across n-grams (n = 1, 2, 3, 4).

Let S = source sentence tokens, P = prediction tokens, and R = set of reference simplifications

For n-gram order n:

Keep (F1 score):
- Keep_precision = |{ngrams kept from S that appear in R}| / |{ngrams kept from S}|
- Keep_recall = |{ngrams in S∩R that appear in P}| / |{ngrams in S union R}|
- Keep_F1 = 2 × (Keep_precision × Keep_recall) / (Keep_precision + Keep_recall)

Delete (F1 score):
- Del_precision = |{ngrams deleted from S that don't appear in R}| / |{ngrams deleted from S}|
- Del_recall = |{ngrams in S not in R that are deleted}| / |{ngrams in S not in R}|
- Del_F1 = 2 × (Del_precision × Del_recall) / (Del_precision + Del_recall)

Add (Precision only):
- Add_precision = |{ngrams added to P that appear in R}| / |{ngrams added to P}|


Final SARI = (1/3) × Σ_{n=1}^{4} (Keep_F1_n + Del_F1_n + Add_precision_n) / 4 × 100

Scores range from 0-100, with a higher score being better. A typical good score can range from 35-45

Example Usage: 

The sari function can be called from other files for training, or you can run it on text files using the command line:

python score.py --outputs outputs.txt --references refs.txt --sources sources.txt

Where the three text files are:

outputs.txt: One simplified sentence per line (the simplified sentence generated by a model)

sources.txt: One source sentence per line (the original complicated sentence)

refs.txt: One reference per line (the human-created baseline to compare the outputs to)

Example Output: 

==================================================
SARI Score Results
==================================================
Number of samples: 3

  SARI:        13.01
    - Keep:    12.60
    - Delete:  26.43
    - Add:     0.00
==================================================